{
	"fetch_puzzles": {
		"params": [],
		"query": "select id,title,date,forecolor,backcolor,textcolor,preview,rating from puzzles",
		"external": true
	},
	"fetch_puzzle": {
		"params": ["?puzzle_id?"],
		"query": "select id,title,date,forecolor,backcolor,textcolor,preview,rating from puzzles where id=?puzzle_id?",
		"external": true
	},
	"fetch_puzzle_paths": {
		"params": ["?puzzle_id?"],
		"query": "select text,shapes_outline,shapes_inline from puzzles where id=?puzzle_id?",
		"external": true
	},
	"fetch_collection_top_rated": {
		"params": [],
		"query": "",
		"external": true
	},
	"fetch_collection_editors_choice": {
		"params": [],
		"query": "",
		"external": true
	},
	"search_puzzles": {
		"params": [],
		"query": "select id,title,date,forecolor,backcolor,textcolor,preview from puzzles where ?regexps?",
		"external": true,
		"special": true
	},
	"rate": {
		"params": ["?username?","?puzzle_id?","?rating?"],
		"query": "call add_rating(?username?,?puzzle_id?,?rating?)",
		"external": false
	},
	"fetch_rating": {
		"params": ["?username?","?puzzle_id?"],
		"query": "select rating from ratings where username=?username? and puzzle_id=?puzzle_id?",
		"external": false
	},
	"login": {
		"params": ["?username?","?password?"],
		"query": "call authenticate_person(?username?,?password?)",
		"external": false
	},
	"user_exists": {
		"params": ["?username?"],
		"query": "select exists(select 1 from people where username=?username? limit 1) as taken",
		"external": true
	},
	"register": {
		"params": ["?username?","?password?","?email?","?subscribed?"],
		"query": "insert into people(username,`password`,email,subscription) values (?username?,?password?,?email?,?subscribed?)",
		"external": false
	},
	"activate": {
		"params": ["?username?"],
		"query": "update people set enabled=true where username=?username?",
		"external": false
	},
 	"fetch_user": {
    	"params": ["?username?"],
		"query": "select username,enabled,admin,subscription,email from people where username=?username?",
		"external": false
	},
	"fetch_user_details": {
		"params": ["?username?"],
		"query": "select admin,enabled,bio,email,links,photo,subscription from people where username=?username?",
		"external": true
	},
	"fetch_user_plays": {
		"params": ["?username?","?puzzle_id?"],
		"query": "select count(*) as times, min(duration) as fastest from plays where username=?username? and puzzle_id=?puzzle_id?",
		"external": false
	},
	"fetch_works": {
		"params": ["?username?"],
		"query": "select id,title,`text`,`date`,description,license from works where author=?username? order by `date` desc, title asc",
		"external": true
	},
	"update_user": {
		"params": ["?username?","?changes?"],
		"query": "update people set ?changes? where username=?username?",
		"external": false,
		"special": true
	},
	"contribute": {
		"params": ["?author?","?title?","?text?","?description?","?date?","?license?"],
		"query": "insert into works(title,`text`,`date`,description,author,license) values (?title?,?text?,?date?,?description?,?author?,?license?)",
		"external": false
	}
}

